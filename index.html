<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DeD_u1ya | Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0e0e10;
            --twitch-purple: #9146ff;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
        }
        * { cursor: none !important; -webkit-tap-highlight-color: transparent; outline: none; }
        body {
            margin: 0; font-family: 'Outfit', sans-serif;
            background-color: var(--bg-dark); color: var(--white);
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; overflow: hidden;
            background: radial-gradient(circle at 50% 0%, #1f1635 0%, var(--bg-dark) 100%);
            position: relative;
        }
        .bg-orbs { position: fixed; inset: 0; pointer-events: none; z-index: 0; overflow: hidden; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.15; background: var(--twitch-purple); animation: float 20s infinite ease-in-out; }
        .orb-1 { width: 400px; height: 400px; top: -100px; left: -100px; animation-duration: 25s; }
        .orb-2 { width: 300px; height: 300px; bottom: -50px; right: -50px; background: #6441a5; animation-duration: 18s; animation-delay: -5s; }
        .orb-3 { width: 250px; height: 250px; top: 40%; left: 60%; background: #9146ff; animation-duration: 30s; animation-delay: -10s; }
        @keyframes float { 0%, 100% { transform: translate(0, 0) scale(1); } 33% { transform: translate(30px, 50px) scale(1.1); } 66% { transform: translate(-20px, 20px) scale(0.9); } }
        #content-wrapper { width: 100%; display: flex; flex-direction: column; align-items: center; transition: 1s ease-in-out; filter: blur(20px); position: relative; z-index: 2; }
        
        #welcome-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 50000; backdrop-filter: blur(25px); transition: 0.6s; padding: 20px;
        }
        .welcome-title { font-size: clamp(32px, 8vw, 48px); font-weight: 900; margin-bottom: 10px; text-shadow: 0 0 20px var(--twitch-purple); text-align: center; }
        .welcome-sub-box { 
            background: var(--glass); border: 1px solid var(--glass-border); padding: 15px 25px; 
            border-radius: 15px; margin-bottom: 30px; max-width: 300px; text-align: center;
            font-size: 14px; color: rgba(255,255,255,0.7); line-height: 1.4;
        }
        .ok-btn { background: var(--twitch-purple); border: none; color: white; padding: 15px 40px; border-radius: 12px; font-weight: 900; font-size: 16px; transition: 0.3s; cursor: pointer; }
        .ok-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--twitch-purple); }

        #cursor-glow, #cursor-dot { position: fixed; pointer-events: none; z-index: 999999; left: 0; top: 0; display: block; }
        #cursor-glow { width: 300px; height: 300px; background: radial-gradient(circle, rgba(145, 70, 255, 0.15) 0%, transparent 70%); transform: translate(-50%, -50%); }
        #cursor-dot { width: 6px; height: 6px; background: white; border-radius: 50%; box-shadow: 0 0 15px var(--twitch-purple); transform: translate(-50%, -50%); }
        @media (hover: none) and (pointer: coarse) { #cursor-glow, #cursor-dot { display: none !important; } * { cursor: auto !important; } }
        
        main { width: 100%; max-width: 420px; padding: 40px 20px 120px; text-align: center; z-index: 10; perspective: 1200px; box-sizing: border-box; }
        .avatar-container { width: 110px; height: 110px; margin: 0 auto 15px; border-radius: 50%; border: 2px solid var(--twitch-purple); padding: 5px; transition: 0.3s; position: relative; }
        .avatar-img { width: 100%; height: 100%; border-radius: 50%; background: url('ava.jpg') center/cover; }
        .links { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; width: 100%; }
        .card { 
            display: flex; align-items: center; padding: 16px 20px; background: var(--glass); border: 2px solid transparent; border-radius: 16px; 
            text-decoration: none; color: white; font-weight: 700; transition: all 0.2s ease-out; transform-style: preserve-3d;
            opacity: 0; transform: translateY(20px); box-sizing: border-box; width: 100%;
        }
        .card.show { opacity: 1; transform: translateY(0); }
        @media (hover: hover) { .card:hover { border-color: var(--twitch-purple); background: rgba(145, 70, 255, 0.1); box-shadow: 0 0 15px rgba(145, 70, 255, 0.3); } }
        .card img, .card svg { width: 22px; height: 22px; margin-right: 15px; flex-shrink: 0; }
        
        #music-player {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(15, 15, 20, 0.85); backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: 50px;
            padding: 8px 16px; display: flex; align-items: center; gap: 8px;
            z-index: 30000; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            width: fit-content; max-width: 95vw; will-change: left, top;
        }
        .visualizer { display: flex; align-items: flex-end; gap: 3px; height: 14px; }
        .vis-bar { width: 3px; background: var(--twitch-purple); border-radius: 1px; height: 4px; }
        .playing .vis-bar { animation: wave 0.8s ease-in-out infinite; }
        .playing .vis-bar:nth-child(2) { animation-delay: 0.1s; }
        .playing .vis-bar:nth-child(3) { animation-delay: 0.2s; }
        @keyframes wave { 0%, 100% { height: 4px; } 50% { height: 14px; } }
        .p-btn { background: none; border: none; color: white; padding: 6px; display: flex; }
        .p-btn svg { width: 18px; height: 18px; fill: currentColor; }
        #playPauseBtn { background: var(--twitch-purple); border-radius: 50%; padding: 8px; }
        #settings-menu { display: none; position: absolute; bottom: 65px; right: 0; background: rgba(20, 20, 25, 0.98); border: 1px solid var(--glass-border); padding: 15px; border-radius: 20px; width: 160px; }
        .sett-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; font-size: 14px; }
        .falling-phrase { position: fixed; pointer-events: none; font-weight: 900; color: white; text-shadow: 0 0 10px var(--twitch-purple); z-index: 10000; font-size: 1.1rem; white-space: nowrap; }
        #snow-canvas { position: fixed; inset: 0; pointer-events: none; z-index: 1; }
        input[type=range] { width: 40px; accent-color: var(--twitch-purple); }

        #secret-lock {
            position: fixed; bottom: 20px; right: 20px; width: 40px; height: 40px;
            background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s; z-index: 40000;
        }
        #secret-lock:hover { background: var(--twitch-purple); box-shadow: 0 0 15px var(--twitch-purple); }
        #secret-lock svg { width: 20px; height: 20px; fill: white; }
        #riddle-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 50000;
            display: none; align-items: center; justify-content: center; backdrop-filter: blur(10px);
        }
        .riddle-box {
            background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px; border-radius: 20px; text-align: center; max-width: 400px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); backdrop-filter: blur(20px);
            transform: scale(0.9); transition: 0.3s;
        }
        .riddle-text { font-size: 20px; font-weight: 700; margin-bottom: 20px; }
        .liquid-input {
            width: 100%; padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255, 255, 255, 0.05); color: white; font-family: 'Outfit', sans-serif;
            font-size: 18px; text-align: center; margin-bottom: 20px; box-sizing: border-box;
            transition: 0.3s;
        }
        .liquid-input:focus { background: rgba(255, 255, 255, 0.1); border-color: var(--twitch-purple); box-shadow: 0 0 15px rgba(145, 70, 255, 0.3); }

        #secret-scene {
            position: fixed; inset: 0; background: black; z-index: 60000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; transition: opacity 2s ease;
        }
        .scene-content { display: flex; align-items: center; gap: 30px; margin-bottom: 40px; }
        .ded-photo { width: 200px; height: 200px; border-radius: 20px; border: 3px solid var(--twitch-purple); box-shadow: 0 0 30px var(--twitch-purple); object-fit: cover; }
        .dialog-box {
            width: 300px; padding: 20px; background: rgba(20, 20, 20, 0.9);
            border: 1px solid var(--twitch-purple); border-radius: 15px;
            font-size: 18px; line-height: 1.5; color: #ddd; min-height: 100px;
            display: flex; align-items: center;
        }
        .scene-choices { display: flex; gap: 20px; opacity: 0; transition: 1s; }
        .choice-btn {
            background: transparent; border: 1px solid var(--twitch-purple); color: var(--twitch-purple);
            padding: 10px 25px; font-weight: 700; font-size: 16px; border-radius: 8px; transition: 0.3s; cursor: none;
        }
        .choice-btn:hover { background: var(--twitch-purple); color: white; box-shadow: 0 0 15px var(--twitch-purple); }

        #secret-video { position: fixed; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: 70000; display: none; background: black; }
        .video-hint { 
            position: fixed; top: 20px; left: 20px; z-index: 70001; color: white; opacity: 0.5; 
            font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
            background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; pointer-events: none;
            display: none;
        }

        @media (hover: none) and (pointer: coarse) { #secret-lock { display: none !important; } }
    </style>
</head>
<body>
    <div class="bg-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>
    <canvas id="snow-canvas"></canvas>
    <div id="cursor-glow"></div>
    <div id="cursor-dot"></div>
    
    <div id="welcome-overlay">
        <div class="welcome-title">Всем привет!</div>
        <div class="welcome-sub-box">Здесь находятся все мои ссылки, спасибо что зашли</div>
        <button class="ok-btn" id="startBtn">ВОЙТИ</button>
    </div>

    <div id="content-wrapper">
        <main>
            <div class="avatar-container" id="avatar"><div class="avatar-img"></div></div>
            <h1>DeD_u1ya</h1>
            <div class="links">
                <a href="https://t.me/DeD_u1ya" target="_blank" class="card"><img src="tg.png"> Telegram</a>
                <a href="https://steamcommunity.com/id/_D_I_C_H_/" target="_blank" class="card"><img src="Без названия (1).png"> Steam</a>
                <a href="https://www.tiktok.com/@dedu1ya1" target="_blank" class="card"><svg fill="white" viewBox="0 0 24 24"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.17-2.81-.74-3.94-1.67-.49-.42-.94-.87-1.33-1.38v7.41c.01 2.23-.74 4.54-2.4 6.06-1.8 1.7-4.4 2.15-6.68 1.4-2.73-.85-4.6-3.7-4.2-6.53.28-2.4 2.1-4.52 4.48-5.11.83-.22 1.7-.26 2.54-.15v4.1c-.88-.25-1.85-.08-2.55.51-.77.62-1.08 1.66-.89 2.62.2 1.05 1.13 1.88 2.19 2.03.95.14 2-.15 2.59-.92.36-.45.56-1.02.55-1.6V.02z"/></svg> TikTok</a>
                <a href="https://www.donationalerts.com/r/ded_u1ya" target="_blank" class="card"><svg fill="#ffa500" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg> DonationAlerts</a>
                <a href="https://www.youtube.com/@DeD_u1ya" target="_blank" class="card"><img src="yt.png"> YouTube</a>
            </div>
        </main>
        <div id="secret-lock">
            <svg viewBox="0 0 24 24"><path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6z"/></svg>
        </div>
        <div id="music-player">
            <div class="visualizer" id="viz"><div class="vis-bar"></div><div class="vis-bar"></div><div class="vis-bar"></div></div>
            <div style="font-size:11px; min-width:35px; color:var(--twitch-purple); font-weight:700" id="currentTime">0:00</div>
            <button class="p-btn" id="prevBtn"><svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg></button>
            <button class="p-btn" id="playPauseBtn"><svg id="playPauseIcon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></button>
            <button class="p-btn" id="nextBtn"><svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></button>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.2">
            <button class="p-btn" id="settBtn"><svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg></button>
            <div id="settings-menu">
                <div class="sett-row"><span>Снег</span><input type="checkbox" id="nyToggle" checked></div>
                <div class="sett-row"><span>Shuffle</span><input type="checkbox" id="shuffleToggle"></div>
            </div>
        </div>
    </div>
    <audio id="bgMusic"></audio>
    <div id="riddle-modal">
        <div class="riddle-box">
            <div class="riddle-text">Решите загадку и замок откроется<br><br>"Во что играет дед но называет парашей?"</div>
            <input type="text" class="liquid-input" id="riddle-answer" placeholder="Введите ответ...">
        </div>
    </div>
    <div id="secret-scene">
        <div class="scene-content">
            <img src="DeD.png" class="ded-photo">
            <div class="dialog-box" id="typewriter"></div>
        </div>
        <div class="scene-choices" id="choices">
            <button class="choice-btn" id="exit-quest-btn">Выйду отсюда</button>
            <button class="choice-btn" id="watch-video-btn">А что еще надо то</button>
        </div>
    </div>
    <div class="video-hint" id="vidHint">Нажмите ESC, чтобы выйти</div>
    <video id="secret-video" src="Bombiz.mp4"></video>

    <script>
        const audio = document.getElementById('bgMusic');
        const tracks = ['1.mp3', '2.mp3', '3.mp3', '4.mp3', '5.mp3', '6.mp3', '7.mp3']; 
        let curT = 0, shuffle = false, drag = false, ox, oy, cooldown = false;
        const player = document.getElementById('music-player'), viz = document.getElementById('viz');
        const icon = document.getElementById('playPauseIcon').querySelector('path');
        const cGlow = document.getElementById('cursor-glow'), cDot = document.getElementById('cursor-dot');
        function loadT(i) { audio.src = tracks[i]; audio.load(); }
        loadT(0);
        document.getElementById('playPauseBtn').onclick = () => { if(audio.paused) { audio.play(); viz.classList.add('playing'); icon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z'); } else { audio.pause(); viz.classList.remove('playing'); icon.setAttribute('d', 'M8 5v14l11-7z'); } };
        document.getElementById('nextBtn').onclick = () => { curT = shuffle ? Math.floor(Math.random()*tracks.length) : (curT+1)%tracks.length; loadT(curT); audio.play(); viz.classList.add('playing'); icon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z'); };
        document.getElementById('prevBtn').onclick = () => { curT = (curT-1+tracks.length)%tracks.length; loadT(curT); audio.play(); viz.classList.add('playing'); icon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z'); };
        document.getElementById('volumeSlider').oninput = (e) => audio.volume = e.target.value;
        document.getElementById('shuffleToggle').onchange = (e) => shuffle = e.target.checked;
        audio.ontimeupdate = () => { const m = Math.floor(audio.currentTime / 60), s = Math.floor(audio.currentTime % 60); document.getElementById('currentTime').innerText = `${m}:${s<10?'0':''}${s}`; };
        audio.onended = () => document.getElementById('nextBtn').click();
        document.getElementById('settBtn').onclick = (e) => { e.stopPropagation(); const m = document.getElementById('settings-menu'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; };
        window.onclick = () => document.getElementById('settings-menu').style.display = 'none';
        document.querySelectorAll('.card').forEach(el => { el.addEventListener('mousemove', (e) => { if(window.matchMedia("(hover: hover)").matches) { const r = el.getBoundingClientRect(), x = e.clientX - r.left - r.width/2, y = e.clientY - r.top - r.height/2; el.style.transform = `perspective(1000px) translate(${x*0.1}px, ${y*0.1}px) rotateX(${-y*0.05}deg) rotateY(${x*0.05}deg) scale(1.02)`; } }); el.addEventListener('mouseleave', () => el.style.transform = ''); });
        const phrases = ["Бля буду", "Ой напьюсь я", "Здарова плесень"];
        document.getElementById('avatar').onclick = (e) => {
            if(cooldown) return; cooldown = true;
            const p = document.createElement('div'); p.className = 'falling-phrase'; p.innerText = phrases[Math.floor(Math.random()*phrases.length)]; document.body.appendChild(p);
            let x = e.type === 'click' ? e.clientX : e.touches[0].clientX, y = e.type === 'click' ? e.clientY : e.touches[0].clientY;
            let vx = (Math.random()-0.5)*10, vy = -8, g = 0.4;
            function anim() { x += vx; vy += g; y += vy; p.style.left = x + 'px'; p.style.top = y + 'px'; p.style.opacity = parseFloat(p.style.opacity || 1) - 0.02; if(y < window.innerHeight && parseFloat(p.style.opacity) > 0) requestAnimationFrame(anim); else p.remove(); }
            anim(); setTimeout(() => cooldown = false, 1500);
        };
        player.onmousedown = (e) => { if(e.target.closest('button') || e.target.closest('input')) return; drag = true; const r = player.getBoundingClientRect(); ox = e.clientX - r.left; oy = e.clientY - r.top; player.style.transition = 'none'; };
        window.onmousemove = (e) => {
            cDot.style.left = cGlow.style.left = e.clientX + 'px'; cDot.style.top = cGlow.style.top = e.clientY + 'px';
            if(drag) { player.style.left = (e.clientX - ox + player.offsetWidth / 2) + 'px'; player.style.top = (e.clientY - oy + player.offsetHeight / 2) + 'px'; player.style.bottom = 'auto'; player.style.transform = 'translateX(-50%)'; }
        };
        window.onmouseup = () => { drag = false; player.style.transition = '0.3s cubic-bezier(0.2, 0.8, 0.2, 1)'; };
        const canvas = document.getElementById('snow-canvas'), ctx = canvas.getContext('2d'), nyT = document.getElementById('nyToggle');
        let flakes = []; 
        function initSnow() {
            canvas.width = window.innerWidth; 
            canvas.height = window.innerHeight;
            if(flakes.length === 0) {
                for(let i=0; i<80; i++) {
                    flakes.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        r: Math.random() * 2 + 0.5, 
                        d: Math.random() * 1 + 0.5, 
                        a: Math.random() * Math.PI * 2, 
                        o: Math.random() * 0.5 + 0.3 
                    });
                }
            }
        }
        window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
        initSnow();
        function drawSnow() { 
            ctx.clearRect(0,0,canvas.width,canvas.height); 
            if(nyT.checked) { 
                flakes.forEach(p => { 
                    ctx.fillStyle = `rgba(255,255,255, ${p.o})`;
                    ctx.beginPath(); 
                    ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); 
                    ctx.fill(); 
                    p.y += p.d; 
                    p.x += Math.sin(p.a) * 0.5; 
                    p.a += 0.02; 
                    if(p.y > canvas.height) { p.y = -5; p.x = Math.random() * canvas.width; }
                    if(p.x > canvas.width) p.x = 0;
                    if(p.x < 0) p.x = canvas.width;
                }); 
            } 
            requestAnimationFrame(drawSnow); 
        }
        drawSnow();
        const lock = document.getElementById('secret-lock');
        const modal = document.getElementById('riddle-modal');
        const input = document.getElementById('riddle-answer');
        const scene = document.getElementById('secret-scene');
        const wrapper = document.getElementById('content-wrapper');
        const twBox = document.getElementById('typewriter');
        const choices = document.getElementById('choices');
        const vid = document.getElementById('secret-video');
        const vidHint = document.getElementById('vidHint');

        lock.onclick = () => { modal.style.display = 'flex'; setTimeout(() => document.querySelector('.riddle-box').style.transform = 'scale(1)', 10); };
        modal.onclick = (e) => { if(e.target === modal) modal.style.display = 'none'; };
        input.oninput = () => {
            if(input.value.toLowerCase().trim() === 'dota 2') {
                modal.style.display = 'none';
                wrapper.style.opacity = '0';
                setTimeout(() => {
                    wrapper.style.display = 'none';
                    scene.style.display = 'flex';
                    setTimeout(() => scene.style.opacity = '1', 100);
                    startDialog();
                }, 1000);
            }
        };
        function startDialog() {
            const text = "Дарова плесень, видно ты умен и что будешь делать дальше?";
            let i = 0;
            twBox.innerHTML = '';
            function type() {
                if(i < text.length) { twBox.innerHTML += text.charAt(i); i++; setTimeout(type, 50); }
                else { choices.style.opacity = '1'; }
            }
            setTimeout(type, 1000);
        }
        function returnToHub() {
            vid.pause();
            vid.style.display = 'none';
            vidHint.style.display = 'none';
            scene.style.opacity = '0';
            setTimeout(() => {
                scene.style.display = 'none';
                wrapper.style.display = 'flex';
                setTimeout(() => wrapper.style.opacity = '1', 50);
                input.value = '';
                audio.play(); 
            }, 500);
        }
        document.getElementById('exit-quest-btn').onclick = returnToHub;
        document.getElementById('watch-video-btn').onclick = () => {
            vid.style.display = 'block';
            vidHint.style.display = 'block';
            vid.play();
            audio.pause();
        };
        window.onkeydown = (e) => {
            if(e.key === 'Escape') {
                if(vid.style.display === 'block' || scene.style.display === 'flex' || modal.style.display === 'flex') {
                    returnToHub();
                }
            }
        };
        document.getElementById('startBtn').onclick = () => {
            document.getElementById('welcome-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('welcome-overlay').style.display = 'none';
                document.getElementById('content-wrapper').style.filter = 'none';
                document.querySelectorAll('.card').forEach((c, i) => { setTimeout(() => c.classList.add('show'), i * 120); });
                audio.play(); viz.classList.add('playing'); icon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z');
            }, 600);
        };
    </script>
</body>
</html>
